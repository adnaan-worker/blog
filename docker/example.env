# ================================================================================
# 博客系统 Docker 部署环境变量配置
# ================================================================================
# 说明：
# 1. 本文件用于 Docker Compose 部署，包含前后端所有配置
# 2. 生产环境请修改所有密码和密钥
# 3. 配置按【后端配置】和【前端配置】两大区域组织
# 4. 每个配置项都有详细的中文注释说明
# ================================================================================

# ================================================================================
# 【后端配置】Backend Configuration
# ================================================================================

# ========================================
# 1. 基础环境配置
# ========================================

# 运行环境 - development(开发) | production(生产) | test(测试)
NODE_ENV=production

# 后端服务器端口 - API服务器监听的端口号
PORT=8200

# 日志级别 - error(错误) | warn(警告) | info(信息) | debug(调试)
LOG_LEVEL=info

# 日志文件路径 - 日志文件存储的目录路径
LOG_FILE_PATH=./logs

# 是否启用系统监控 - true启用性能监控和健康检查, false禁用
ENABLE_MONITORING=true

# ========================================
# 2. 数据库配置 (MySQL)
# ========================================

# MySQL连接配置 - 后端应用连接数据库使用
DB_HOST=mysql
DB_PORT=3306
DB_NAME=blog_prod
DB_USER=blog_user
DB_PASSWORD=dy03280411

# MySQL容器配置 - Docker容器初始化使用
MYSQL_ROOT_PASSWORD=dy03280411
MYSQL_DATABASE=blog_prod
MYSQL_USER=blog_user
MYSQL_PASSWORD=dy03280411
MYSQL_CHARACTER_SET_SERVER=utf8mb4
MYSQL_COLLATION_SERVER=utf8mb4_unicode_ci

# 数据库连接池配置 - 优化数据库连接性能
# 最大连接数 - 连接池中允许的最大连接数
DB_POOL_MAX=20
# 最小连接数 - 连接池中保持的最小连接数
DB_POOL_MIN=5
# 获取连接超时(毫秒) - 从连接池获取连接的最大等待时间
DB_POOL_ACQUIRE=30000
# 空闲超时(毫秒) - 连接在池中空闲多久后被释放
DB_POOL_IDLE=10000

# ========================================
# 3. Redis缓存配置
# ========================================

# Redis基础连接配置
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=1
REDIS_PASSWORD=dy03280411

# Redis高级配置 - 性能与稳定性优化
# 连接超时(毫秒) - 建立Redis连接的最大等待时间
REDIS_CONNECT_TIMEOUT=30000
# 命令超时(毫秒) - 单个Redis命令执行的最大等待时间
REDIS_COMMAND_TIMEOUT=10000
# 故障转移重试延迟(毫秒) - 主从切换时的重试延迟
REDIS_RETRY_DELAY_ON_FAILOVER=100
# 最大重试次数 - 单个请求的最大重试次数
REDIS_MAX_RETRIES=5
# 懒加载连接 - true为懒加载, false为立即连接
REDIS_LAZY_CONNECT=false
# 保持连接时间(毫秒) - TCP keepalive时间
REDIS_KEEP_ALIVE=30000
# 最大加载超时(毫秒) - 数据加载的最大等待时间
REDIS_MAX_LOADING_TIMEOUT=5000
# 重连最大尝试次数 - 连接断开后的最大重连次数
REDIS_MAX_RETRY_ATTEMPTS=20
# 重连基础延迟(毫秒) - 重连时的基础延迟时间
REDIS_RETRY_DELAY=200
# 重连最大延迟(毫秒) - 指数退避重连的最大延迟时间
REDIS_MAX_RETRY_DELAY=3000

# ========================================
# 4. JWT身份验证配置
# ========================================

# JWT密钥 - 用于签名和验证JWT令牌(生产环境必须修改为强随机字符串)
JWT_SECRET=25756f4d004709ae1f84af6ca9fe5bf641ad44672e9444631c088fec154ebd80
# JWT过期时间 - 访问令牌的有效期(1d=1天, 1h=1小时)
JWT_EXPIRES_IN=1d
# JWT刷新令牌过期时间 - 刷新令牌的有效期
JWT_REFRESH_EXPIRES_IN=7d

# ========================================
# 5. 跨域配置 (CORS)
# ========================================

# 允许的源地址 - 允许跨域请求的前端地址列表(逗号分隔)
ALLOWED_ORIGINS=http://www.adnaan.cn,http://api.adnaan.cn

# ========================================
# 6. Socket.IO实时通信配置
# ========================================

# Socket.IO基础配置
# 是否启用Socket.IO - true启用实时通信功能, false禁用
SOCKET_IO_ENABLED=true
# Socket.IO认证密钥 - 客户端连接时的认证密钥(生产环境必须修改)
SOCKET_IO_AUTH_KEY=duyong-socket-328
# Socket.IO跨域源 - 允许Socket.IO连接的源地址(包括WebSocket协议)
SOCKET_IO_CORS_ORIGIN=http://www.adnaan.cn,http://api.adnaan.cn,ws://www.adnaan.cn,ws://api.adnaan.cn
# Socket.IO路径 - Socket.IO服务的URL路径
SOCKET_IO_PATH=/socket.io

# Socket.IO连接配置
# Ping超时(毫秒) - 等待客户端pong响应的最大时间
SOCKET_IO_PING_TIMEOUT=60000
# Ping间隔(毫秒) - 服务器发送ping包的间隔时间
SOCKET_IO_PING_INTERVAL=25000
# 升级超时(毫秒) - 从轮询升级到WebSocket的超时时间
SOCKET_IO_UPGRADE_TIMEOUT=10000
# 最大HTTP缓冲区大小(字节) - 单个HTTP请求的最大大小
SOCKET_IO_MAX_HTTP_BUFFER_SIZE=1000000
# 传输方式 - 支持的传输协议(polling轮询, websocket)
SOCKET_IO_TRANSPORTS=polling,websocket

# Socket.IO限流与安全配置
# 最大连接数 - 服务器允许的最大并发连接数
SOCKET_IO_MAX_CONNECTIONS=1000
# 速率限制连接数 - 每个IP每分钟允许的最大连接数
SOCKET_IO_RATE_LIMIT_CONNECTIONS=10
# 速率限制重置间隔(毫秒) - 连接计数重置的时间间隔
SOCKET_IO_RATE_LIMIT_RESET_INTERVAL=60000

# ========================================
# 7. AI服务配置
# ========================================

# AI提供商配置
# AI服务提供商 - openai(OpenAI) | zhipu(智谱AI) | baidu(百度) | aliyun(阿里云)
AI_PROVIDER=zhipu
# AI API密钥 - 对应AI服务提供商的API密钥(生产环境必须修改)
AI_API_KEY=72ac0ef42495dced6a5f5d54.kLksNMjOBCKB0vKH

# AI模型配置(可选)
# AI模型名称 - 使用的具体AI模型(如gpt-4, glm-4等, 不指定则使用默认模型)
# AI_MODEL=glm-4
# 自定义Base URL - 用于AI网关或代理(可选)
# AI_BASE_URL=https://your-gateway.com/v1

# AI模型参数
# AI温度参数 - 控制AI回答的创造性(0.0-1.0, 越高越有创造性)
AI_TEMPERATURE=0.7
# AI最大令牌数 - AI单次回应的最大字符数限制
AI_MAX_TOKENS=2000

# AI请求配置
# AI请求超时(毫秒) - AI API请求的超时时间
AI_TIMEOUT=30000
# AI最大重试次数 - AI请求失败后的最大重试次数
AI_MAX_RETRIES=3
# AI重试延迟(毫秒) - AI请求重试的延迟时间
AI_RETRY_DELAY=1000

# AI并发控制
# 每用户最大并发数 - 单个用户同时进行的最大AI请求数
AI_MAX_CONCURRENT_PER_USER=3

# AI历史消息配置
# 最大历史消息数 - AI对话保留的最大历史消息数量
AI_MAX_HISTORY_MESSAGES=20

# AI默认Prompt类型 - 默认使用的System Prompt类型
AI_DEFAULT_PROMPT_TYPE=WRITING

# ========================================
# 8. 业务服务配置 (缓存与清理策略)
# ========================================

# 状态服务配置
# 无活动阈值(毫秒) - 多长时间无活动认为不活跃(1800000=30分钟)
STATUS_INACTIVE_THRESHOLD=1800000
# 清理阈值(毫秒) - 多长时间无活动后清理缓存(3600000=1小时)
STATUS_CLEANUP_THRESHOLD=3600000
# 自动清理间隔(毫秒) - 定期检查清理的时间间隔(300000=5分钟)
STATUS_AUTO_CLEANUP_INTERVAL=300000
# 音乐状态过期时间(秒) - 音乐状态在Redis中的过期时间(3600=1小时)
STATUS_MUSIC_EXPIRE_TIME=3600
# 最多保留活跃应用数 - 状态历史中保留的最大应用数量
STATUS_MAX_ACTIVE_APPS=3
# 应用状态过期时间(秒) - 应用状态在Redis中的过期时间(86400=24小时)
STATUS_APP_EXPIRE_TIME=86400

# 代理服务缓存配置(秒)
# IP定位缓存时间 - IP地理位置信息的缓存时间(3600=1小时)
PROXY_IP_LOCATION_TTL=3600
# 天气缓存时间 - 天气信息的缓存时间(1800=30分钟)
PROXY_WEATHER_TTL=1800
# 音乐URL缓存时间 - 音乐播放URL的缓存时间(86400=24小时)
PROXY_MUSIC_URL_TTL=86400

# 访客统计配置
# 访客活动过期阈值(毫秒) - 清理过期访客活动的时间阈值(300000=5分钟)
VISITOR_STATS_EXPIRE_THRESHOLD=300000

# GitHub集成配置
# GitHub请求超时(毫秒) - GitHub API请求的超时时间
GITHUB_REQUEST_TIMEOUT=10000
# GitHub缓存时间(秒) - GitHub贡献数据的缓存时间(900=15分钟)
GITHUB_CACHE_TTL=900

# ================================================================================
# 【前端配置】Frontend Configuration
# ================================================================================

# ========================================
# 9. 前端基础配置
# ========================================

# API基础路径 - 前端请求后端API的基础路径
VITE_API_BASE_URL=/api

# HTTP请求超时(毫秒) - 全局HTTP请求的超时时间
VITE_REQUEST_TIMEOUT=30000

# 应用信息配置
# 应用标题 - 显示在浏览器标签页的标题
VITE_APP_TITLE=博客系统
# 应用描述 - 应用的描述信息(用于SEO)
VITE_APP_DESCRIPTION=基于Node.js的现代化博客系统
# 应用版本 - 当前应用的版本号
VITE_APP_VERSION=1.0.0
# 应用作者 - 应用的作者信息
VITE_APP_AUTHOR=adnaan

# ========================================
# 10. 前端Socket.IO配置
# ========================================

# Socket.IO连接配置
# Socket.IO服务器地址 - Socket.IO连接的目标地址(HTTP协议)
VITE_SOCKET_URL=http://www.adnaan.cn
# Socket.IO WebSocket地址 - Socket.IO连接的WebSocket地址(WS协议)
VITE_SOCKET_WS_URL=ws://www.adnaan.cn
# Socket.IO认证密钥 - 连接Socket.IO服务器时使用的认证密钥(必须与后端一致)
VITE_SOCKET_IO_AUTH_KEY=duyong-socket-328

# Socket.IO高级配置 - 性能与稳定性优化
# 基础重连延迟(毫秒) - 连接断开后首次重连的延迟时间
VITE_SOCKET_RECONNECT_DELAY=2000
# 最大重连尝试次数 - Socket.IO库级别的最大重连次数
VITE_SOCKET_MAX_RECONNECT_ATTEMPTS=2
# 连接超时(毫秒) - Socket.IO连接建立的超时时间
VITE_SOCKET_TIMEOUT=15000
# 内部管理器最大重连次数 - SocketManager内部的最大重连次数
VITE_SOCKET_MAX_RECONNECT_ATTEMPTS_INTERNAL=10
# 心跳间隔(毫秒) - 向服务器发送心跳包的间隔时间
VITE_SOCKET_HEARTBEAT_INTERVAL=25000
# 非活跃超时(毫秒) - 用户无操作多长时间后断开连接(300000=5分钟)
VITE_SOCKET_INACTIVITY_TIMEOUT=300000
# 消息确认超时(毫秒) - 等待服务器确认消息的最大时间
VITE_SOCKET_ACK_TIMEOUT=10000
# 消息队列最大大小 - 本地消息队列可容纳的最大消息数量
VITE_SOCKET_MAX_QUEUE_SIZE=100
# 消息过期时间(毫秒) - 队列中消息的最长保存时间(86400000=24小时)
VITE_SOCKET_MESSAGE_EXPIRE_TIME=86400000
# 最大重连延迟(毫秒) - 指数退避重连的最大延迟时间
VITE_SOCKET_RECONNECTION_DELAY_MAX=10000
# 消息重试基础延迟(毫秒) - 消息发送失败后重试的基础延迟时间
VITE_SOCKET_RETRY_BASE_DELAY=1000
# 消息重试最大延迟(毫秒) - 消息重试的最大延迟时间(指数退避上限)
VITE_SOCKET_RETRY_MAX_DELAY=10000
# 手动重连延迟(毫秒) - 手动重连时的延迟时间
VITE_SOCKET_MANUAL_RECONNECT_DELAY=100

# ================================================================================
# 配置说明结束
# ================================================================================
# 注意事项：
# 1. 生产环境必须修改所有密码和密钥(DB_PASSWORD, JWT_SECRET, AI_API_KEY等)
# 2. ALLOWED_ORIGINS和SOCKET_IO_CORS_ORIGIN必须配置为实际的域名
# 3. Socket.IO认证密钥(SOCKET_IO_AUTH_KEY和VITE_SOCKET_IO_AUTH_KEY)必须保持一致
# 4. 所有超时时间单位为毫秒(ms), 缓存时间单位为秒(s)
# 5. 修改配置后需要重启服务才能生效
# ================================================================================